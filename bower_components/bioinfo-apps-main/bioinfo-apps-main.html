<link rel="import" href="../polymer/polymer.html">
<link rel="stylesheet" href="../font-awesome/css/font-awesome.css">
<link rel="import" href="../app-collection/bz-collection.html">
<link rel="import" href="../app-info/app-info.html">

<dom-module id="bioinfo-apps-main">
    <template>
        <style is="custom-style" include="iron-flex">

            :root {
                font-family: Lato;
            }


            .container{
                -webkit-overflow-scrolling: touch;
            }

            .menu_wrapper{
                width: 150px;
                height: 100%;
                position: absolute;
                overflow-x: hidden;
            }

            bz-collection {
                display: block;
                width: 150px;
                position: absolute;
                transform: translate(-150px, 0);
                transition: transform 0.5s;

                padding-right: 40px;
                height: 100vh;
                overflow-y: scroll;
                overflow-x: hidden;
            }


            bz-collection[show] {
                z-index: 100;
                transform: translate(0);
            }

            app-info {
                position: absolute;
                top: 0;
                left: 0;
                transition: left 0.6s;
                height: 100vh;
                overflow-y: scroll;
            }

            .blocking_div{
                width: 100%;
                height: 100%;
                top: 0;
                position: fixed;

                background-color: rgba(0,0,0,0.2);

                z-index: 50;
            }

            @media screen and (min-width: 1200px){
                app-info {
                    left: 150px;
                }

                bz-collection {
                    transform: translate(0);
                }
            }
        </style>

        <div class="container">
            <div class="menu_wrapper">
                <bz-collection id="bzCollection" tabindex="-1"></bz-collection>
            </div>
            <app-info id="appInfo"
                      on-click-menu=""></app-info>
            <div class="blocking_div" id="blockingDiv" hidden></div>
        </div>
    </template>
    <script>
        Polymer({
            is: "bioinfo-apps-main",

            ready: function() {
                jsonRequest("src/test-apps.json", function(response){
                    this.$.bzCollection.appCollectionJson = response;
                    this.$.appInfo.appToDisplay = response[0];
                }.bind(this));

                this.$.appInfo.addEventListener("click-menu", function(){
                    this.$.bzCollection.setAttribute("show", "");
                    this.$.blockingDiv.removeAttribute("hidden");
                }.bind(this));

                this.$.bzCollection.addEventListener("app-selection", function(e){
                    this.$.appInfo.appToDisplay = e.detail;
                    this.hideMenu();
                }.bind(this));

                this.$.blockingDiv.addEventListener("click", this.hideMenu);
            },

            hideMenu: function(){
                Polymer.dom(this.$.bzCollection).removeAttribute("show");
                Polymer.dom(this.$.blockingDiv).setAttribute("hidden", "");
            },

        })
    </script>
</dom-module>